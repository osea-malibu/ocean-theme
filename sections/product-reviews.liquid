{{ 'section-product-reviews.css' | asset_url | stylesheet_tag }}

<div class="{{ section.settings.wrapper_classes }}">
  <span class="block relative -top-32 invisible" id="reviews"></span>
  <div class="container mx-auto px-6 xl:max-w-screen-xl tracking-tight">
    <h2 class="text-center font-serif text-4xl mb-2">{{ section.settings.heading }}</h2>
    {%- if product.metafields.my_fields.reformulation_date != blank -%}
      <div class="bg-seaweed-400/10 p-6 leading-tight tracking-wide max-w-2xl mx-auto">
        <h3 class="font-medium mb-2">This productâ€™s formula was upgraded on {{ product.metafields.my_fields.reformulation_date | date: "%B %d, %Y" }}</h3>
        {%- if product.metafields.my_fields.reformulation_details != blank -%}
          <p>{{ product.metafields.my_fields.reformulation_details }}</p>
        {%- endif -%}
      </div>
    {%- endif -%}
    <div
      id="stamped-main-widget"
      data-product-id="{{ product.id }}"
      data-name="{{ product.title | escape }}"
      data-url="{{ shop.url }}{{ product.url }}"
      data-image-url="{{ product.featured_image | image_url: "large" | replace: '?', '%3F' | replace: '&', '%26' }}"
      data-description="{{ product.description | strip_html | strip_newlines }}"
      data-product-sku="{{ product.handle }}"
      data-product-title="{{ product.title }}"
      data-product-type="{{ product.type }}"
      data-widget-type="minimal"
      data-sort="most-recent"
    >
      {% if product.metafields.stamped.reviews != blank %}
        {{ product.metafields.stamped.reviews }}
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Reviews",
  "tag": "section",
  "settings": [
    {
      "type": "paragraph",
      "content": "Stamped reviews widget"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Customer Reviews"
    },
    {
      "type": "textarea",
      "id": "wrapper_classes",
      "label": "Section classes"
    }
  ]
}
{% endschema %}
