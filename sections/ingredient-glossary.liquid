<div id="IngredientGlossary-{{ section.id }}" class="relative {{ section.settings.wrapper_classes }}">
  <div class="{{ section.settings.container_classes }}">

    {% assign all_categories = ',' | split: ',' %}
    <script>console.log("all_categories", {{ all_categories }})</script>
    
    <!-- Iterate over all metaobjects to collect categories -->
    {% for item in shop.metaobjects.ingredient_glossary.values %}
      {% assign all_categories = all_categories | concat: item.category %}
      <script>console.log("item.category", {{ item.category }})</script>
    {% endfor %}
    
    <!-- Split the string of categories into an array and make them unique -->
    {% assign all_categories = all_categories %}

    <div class="grid grid-cols-1 sm:grid-cols-3">
      <div class="sm:col-span-1">
        <div class="mb-4">
          <p><strong>Filter by category:</strong></p>
          <form id="category-filter-form">
            <ul>
              <li><label><input type="checkbox" value="" checked> All</label></li>
              {% for category in all_categories %}
                <li>
                  <label>
                    <input type="checkbox" name="category" value="{{ category }}">
                    {{ category }}
                  </label>
                </li>
              {% endfor %}
            </ul>
          </form>
        </div>
      </div>
      <div class="sm:col-span-2">
        {% paginate shop.metaobjects.ingredient_glossary.values by items_per_page %}
          <!-- Iterate over the paginated items -->
          {% for item in shop.metaobjects.ingredient_glossary.values %}
            <div class="mb-4">
              <p><b>{{ item.name }}</b></p>
              {%- if item.common_name -%}<em>{{ item.common_name }}</em>{%- endif -%}
              <p>{{ item.definition }}</p>
            </div>
          {% endfor %}
        
          <!-- Display pagination links -->
          <div class="pagination">
            {% if paginate.previous %}
              <a href="{{ paginate.previous.url }}">Previous</a>
            {% endif %}
        
            {% for part in paginate.parts %}
              {% if part.is_link %}
                <a href="{{ part.url }}">{{ part.title }}</a>
              {% else %}
                <span>{{ part.title }}</span>
              {% endif %}
            {% endfor %}
        
            {% if paginate.next %}
              <a href="{{ paginate.next.url }}">Next</a>
            {% endif %}
          </div>
        {% endpaginate %}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Ingredient glossary",
    "tag": "section",
    "settings": [
      {
        "type": "textarea",
        "id": "wrapper_classes",
        "label": "Wrapper classes"
      },
      {
        "type": "textarea",
        "id": "container_classes",
        "label": "Container classes"
      }
    ],
    "presets": [
      {
        "name": "Ingredient glossary"
      }
    ]
  }
{% endschema %}