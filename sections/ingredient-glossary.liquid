<div id="IngredientGlossary-{{ section.id }}" class="relative {{ section.settings.wrapper_classes }}">
  <div class="{{ section.settings.container_classes }}">    
    {%- liquid
      assign items_per_page = 10
      assign all_categories = '' | split: ''
    
      for ingredient in shop.metaobjects.ingredient_glossary.values
        assign all_categories = all_categories | concat: ingredient.category.value
      endfor

      assign all_categories = all_categories | uniq | sort
    -%}

    <ingredient-glossary class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 gap-6 lg:gap-10 pb-8">
      <div class="sm:col-span-1">
        {%- assign form_header_class = 'block font-bold text-sm mb-1' -%}
        {%- assign checkbox_class = 'flex py-1 leading-none items-center gap-1' -%}
        <div class="mb-4">
          <h2 class="border-b border-seaweed-700 mb-2 pb-2 font-bold">Filter and sort</h2>
          <form id="sort-form" class="py-4">
            <h3 class="{{ form_header_class }}">Sort by</h3>
            <select class="input input-sm w-40">
              <option value="az">Name (A-Z)</option>
              <option value="za">Name (Z-A)</option>
            </select>
          </form>
          <form id="filter-form" class="py-4">
            <h3 class="{{ form_header_class }}">Category</h3>
            <ul>
              <li><label class="{{ checkbox_class }}"><input type="checkbox" value="all" checked> All</label></li>
              {% for category in all_categories %}
                <li>
                  <label class="{{ checkbox_class }}">
                    <input type="checkbox" name="category" value="{{ category }}">
                    {{ category }}
                  </label>
                </li>
              {% endfor %}
            </ul>
          </form>
        </div>
      </div>
      <div class="sm:col-span-2 lg:col-span-3">
        {% paginate shop.metaobjects.ingredient_glossary.values by items_per_page %}
          <div class="border-b border-seaweed-700 mb-2 pb-2 flex justify-between">
          <h2 class="font-bold">Ingredients</h2>
          <em class="results-count relative w-20 text-right">
              <div class="absolute inset-0 skeleton bg-wave-400 rounded-md"></div>
          </em>
          </div>
          <div class="ingredient-list">
            <!-- Iterate over the paginated items -->
            {% for ingredient in shop.metaobjects.ingredient_glossary.values %}
              <div class="border-b border-seaweed-300 flex flex-col justify-center h-32">
                <p><b>{{ ingredient.name }}</b></p>
                {%- if ingredient.common_name -%}<em>{{ ingredient.common_name }}</em>{%- endif -%}
                <p class="font-book">{{ ingredient.definition }}</p>
                <div class="flex flex-wrap gap-1 mt-2">
                  {%- for category in ingredient.category.value -%}
                    <div class="rounded-full px-2 py-0.5 bg-wave-200 text-xs font-book">{{ category }}</div>
                  {%- endfor -%}
                </div>
              </div>
            {% endfor %}
          </div>

          <div class="flex justify-between pt-4">
            <!-- Display list  count -->
            <fieldset id="list-count" class="inline-flex items-center">
              <legend class="font-bold text-sm" style="display: contents">Show:</legend>
              {% assign list_counts = '10,50,100' | split: ',' %}
              {% for list_count in list_counts %}
                <input
                  type="radio"
                  name="list-count"
                  id="{{ list_count }}"
                  value="{{ list_count }}"
                  class="hidden"
                  {% if list_count == '10' %} checked{% endif %}
                >
                <label
                  for="{{ list_count }}"
                  class="cursor-pointer px-1{% if list_count == '10' %} font-bold{% endif %}"
                >{{ list_count }}</label>
              {% endfor %}
            </fieldset>
            
            <!-- Display pagination links -->
            <div class="pagination flex items-center gap-2 text-center">
              {% if paginate.previous %}
                <a href="{{ paginate.previous.url }}" class="px-1">
                  {%- render 'icon-chevron', classes: 'w-5 h-5 text-seaweed-700 rotate-180', stroke_width: 2 -%}
                </a>
              {% endif %}
          
              {% for part in paginate.parts %}
                {% if part.is_link %}
                  <a href="{{ part.url }}" class="w-4">{{ part.title }}</a>
                {% else %}
                  <span class="w-4 font-bold">{{ part.title }}</span>
                {% endif %}
              {% endfor %}
          
              {% if paginate.next %}
                <a href="{{ paginate.next.url }}" class="px-1">
                  {%- render 'icon-chevron', classes: 'w-5 h-5 text-seaweed-700 rotate-180', stroke_width: 2 -%}
                </a>
              {% endif %}
            </div>
            
            <!-- Display current count -->
            <div class="current-count w-40 text-right relative">
              <div class="absolute inset-0 skeleton bg-wave-400 rounded-md"></div>
            </div>
          </div>
        {% endpaginate %}
      </div>
    </ingredient-glossary>
  </div>
</div>

{% schema %}
  {
    "name": "Ingredient glossary",
    "tag": "section",
    "settings": [
      {
        "type": "textarea",
        "id": "wrapper_classes",
        "label": "Wrapper classes"
      },
      {
        "type": "textarea",
        "id": "container_classes",
        "label": "Container classes"
      }
    ],
    "presets": [
      {
        "name": "Ingredient glossary"
      }
    ]
  }
{% endschema %}