{% comment %}
  Product card that links to PDP instead of add-to-cart
  Parameters:
  - card_product: Product object
  - section_id: Section ID for unique identifiers
  - pdp_link_label: Custom label for the PDP link button (optional)
  - show_secondary_image_on_hover: Boolean for hover image (optional)
  - card_class: CSS classes for card container (optional)
  - image_class: CSS classes for image container (optional)
  - name_class: CSS classes for product name (optional)
  - description_class: CSS classes for description (optional)
  - badge_class: CSS classes for badge (optional)
  - hide_badge: Boolean to hide badge (optional)
  - remove_linking: Boolean to remove product links (optional)
  - remove_lazy_loading: Boolean to remove lazy loading (optional)
{% endcomment %}

<div class="{% if card_class == blank %}flex flex-col relative grow h-full{% else %}{{ card_class }}{% endif %}">
  <div class="product-info w-full order-1 grow flex flex-col">
    <div>
      {% unless remove_linking %}<a href="{{ card_product.url | default: '#' }}">{% endunless %}
        <h3 class="text-sm 2xs:text-base font-bold 2xs:font-medium !leading-[1.1] hover:underline mb-1{% if name_class != blank %} {{ name_class }}{% endif %}">
          {{- card_product.title | replace: '™', '<sup class="-top-0.5 -mr-0.5 -left-px">™</sup>' | replace: '®', '<sup class="-top-1 -mr-px">®</sup>' -}}
        </h3>
      {% unless remove_linking %}</a>{% endunless %}
    </div>

    <p class="text-sm !leading-[1.1]{% if description_class != blank %} {{ description_class }}{% endif %}">
      {{- card_product.metafields.custom_fields.short_description | escape -}}
    </p>
    
    <div class="mt-auto overflow-hidden px-1 pb-1 -mb-1 -mx-1">
      <a class="button button-tertiary w-full motion-safe:transition flex mt-2" href="{{ card_product.url }}">
        {{- pdp_link_label | default: 'View Details' -}}
      </a>
    </div>
  </div>

  <div class="relative block overflow-hidden no-underline rounded mb-2" tabindex="-1">
    {%- if card_product.featured_media -%}
      {%- if remove_linking -%}
        <div class="group block bg-wave-100{% if image_class != blank %} {{ image_class }}{% endif %}" tabindex="-1">
      {%- else -%}
        <a
          aria-label="{{ card_product.title | escape }}"
          href="{{ card_product.url | default: '#' }}"
          class="group block bg-wave-100{% if image_class != blank %} {{ image_class }}{% endif %}"
          tabindex="-1"
        >
      {%- endif -%}
        {%- liquid
          assign default_image = card_product.featured_media
          assign default_image_src = default_image | image_url: width: 328
          assign default_image_src_2x = default_image | image_url: width: 656
          assign hover_image_src = card_product.media[1] | image_url: width: 328
          assign hover_image_src_2x = card_product.media[1] | image_url: width: 656
        -%}
        {% comment %} theme-check-disable RemoteAsset {% endcomment %}
        <img
          srcset="{% render 'imgix', src: default_image_src %} 1x, {% render 'imgix', src: default_image_src_2x %} 2x"
          src="{% render 'imgix', src: default_image_src %}"
          alt="{% if remove_linking %}{{ default_image.alt | escape }}{% endif %}"
          width="{{ default_image.width }}"
          height="{{ default_image.height }}"
          id="ProductCard-DefaultImage-{{ card_product.id }}-{{ section_id }}"
          {% unless remove_lazy_loading %}loading="lazy"{% endunless %}
          class="object-cover"
        >
        {%- if card_product.media[1] != nil and show_secondary_image_on_hover -%}
          <img
            srcset="{% render 'imgix', src: hover_image_src %} 1x, {% render 'imgix', src: hover_image_src_2x %} 2x"
            src="{% render 'imgix', src: hover_image_src %}"
            alt="{{ card_product.media[1].alt | escape }}"
            loading="lazy"
            class="absolute min-h-full inset-x-0 top-1/2 -translate-y-1/2 bg-cover bg-center bg-wave-100 opacity-0 group-hover:opacity-100 motion-safe:transition-opacity duration-300 object-cover"
            width="{{ card_product.media[1].width }}"
            height="{{ card_product.media[1].height }}"
          >
        {%- endif -%}
        {% comment %} theme-check-enable RemoteAsset {% endcomment %}
        {% if remove_linking %}</div>{% else %}</a>{% endif %}
    {%- else -%}
      <h2 class="h3">
        <a href="{{ card_product.url | default: '#' }}">
          {{ card_product.title }}
        </a>
      </h2>
    {%- endif -%}

    {%- if hide_badge != true -%}
      {% render 'product-badge', product: card_product, classes: badge_class %}
    {%- endif -%}
  </div>
</div> 