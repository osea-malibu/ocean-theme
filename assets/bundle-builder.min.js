(()=>{var H=Object.defineProperty,L=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var g=(r,e,t)=>e in r?H(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,v=(r,e)=>{for(var t in e||(e={}))I.call(e,t)&&g(r,t,e[t]);if(y)for(var t of y(e))x.call(e,t)&&g(r,t,e[t]);return r},w=(r,e)=>L(r,A(e));function $(r="json"){return{method:"POST",headers:{"Content-Type":"application/json",Accept:`application/${r}`}}}var b=class extends HTMLElement{constructor(){super(),this.cart=document.querySelector("cart-drawer"),this.panelProducts=this.querySelector("#ByobPanel .products"),this.querySelectorAll("modal-opener").forEach(e=>e.addEventListener("click",this.handleModalOpen.bind(this))),this.querySelectorAll(".byob-add-to-bundle").forEach(e=>e.addEventListener("click",this.handleAddToBundle.bind(this))),this.querySelectorAll(".byob-add-to-cart").forEach(e=>e.addEventListener("click",this.handleAddToCart.bind(this)))}connectedCallback(){let e=localStorage.getItem("osea.byobFaceProductId"),t=localStorage.getItem("osea.byobBodyProductId");e&&(this.querySelector(`#Input-${e}`).checked=!0),t&&(this.querySelector(`#Input-${t}`).checked=!0),this.renderElements()}getPanelProductHtml(e,t){let o=this.querySelector(`[data-variant-id="${e}"] img`),n=this.querySelector(`[data-variant-id="${e}"] .info`).innerHTML,a=this.querySelector(`[data-variant-id="${e}"] .price`).innerHTML;return`<div class="flex gap-4 py-4 border-b border-white first-of-type:pt-8">
			<img
				srcset="${o.getAttribute("srcset")}"
				srcset="${o.getAttribute("src")}"
				alt=""
				loading="lazy"
				width="{{ product.featured_media.width }}"
				height="{{ product.featured_media.height }}"
				class="block bg-white w-16"
			>
			<div>${n}</div>
			<div class="ml-auto flex flex-col items-end">
				<div class="whitespace-nowrap font-medium">${a}</div>
				<button class="link font-book tracking-wide text-sm" onclick="this.closest('bundle-builder').handleRemove('${e}', '${t}')">Remove</button>
			</div>
		</div>`}getPriceHtml(e,t){return`<div class="flex-row">
			<span class="sr-only">Regular price</span>
			<span>
				<s class="${t}">$${e/100}</s>
			</span>
			<span class="sr-only">Sale price</span>
			<span>$${(e*.8/100).toFixed(2)}</span>
		</div>`}getRemainingHtml(e,t){return e&&t?'<p class="text-lg lg:hidden whitespace-nowrap"><b>2/2</b><span class="hidden xs:inline"> products</span> selected</p><p class="sr-only">Your bundle is complete!</p>':`<p class="text-lg lg:text-2xl whitespace-nowrap"><b>${!e&&!t?0:1}/2</b> products selected</p>
			<p class="hidden lg:block mt-3 leading-5 lg:max-w-sm lg:mx-auto${!e&&!t?" mb-12":""}">
				<span class="system-sans font-medium">\u2190</span> Add ${e?"":"<b>one face</b>"}${!e&&!t?" and ":" "}${t?"":"<b>one body</b>"} product to complete your bundle
			</p>`}renderElements(){let e=localStorage.getItem("osea.byobFaceProductId"),t=localStorage.getItem("osea.byobBodyProductId"),o=this.querySelector("#ByobBar .remaining"),n=this.querySelector("#ByobBar .byob-add-to-cart"),a=this.querySelector("#ByobBar .total-cost"),s=this.querySelectorAll(".byob-add-to-cart"),i=this.querySelectorAll(".total-cost");if(e&&t){let d=parseInt(this.querySelector(`[data-variant-id="${e}"]`).dataset.price),l=parseInt(this.querySelector(`[data-variant-id="${t}"]`).dataset.price),u=d+l;o.innerHTML=this.getRemainingHtml(e,t),o.classList.remove("lg:block"),n.classList.remove("hidden"),a.classList.add("hidden"),s.forEach(h=>h.removeAttribute("disabled")),i.forEach(h=>h.innerHTML=this.getPriceHtml(u,"text-wave-500")),this.panelProducts.innerHTML=`${this.getPanelProductHtml(e,"Face")}${this.getPanelProductHtml(t,"Body")}`}else if(e&&!t){let d=parseInt(this.querySelector(`[data-variant-id="${e}"]`).dataset.price);o.innerHTML=this.getRemainingHtml(e,null),o.classList.add("lg:block"),n.classList.add("hidden"),a.classList.remove("hidden"),s.forEach(l=>l.setAttribute("disabled",!0)),i.forEach(l=>l.innerHTML=this.getPriceHtml(d,"text-seaweed-400")),this.panelProducts.innerHTML=this.getPanelProductHtml(e,"Face")}else if(!e&&t){let d=parseInt(this.querySelector(`[data-variant-id="${t}"]`).dataset.price);o.innerHTML=this.getRemainingHtml(null,t),o.classList.add("lg:block"),n.classList.add("hidden"),a.classList.remove("hidden"),s.forEach(l=>l.setAttribute("disabled",!0)),i.forEach(l=>l.innerHTML=this.getPriceHtml(d,"text-seaweed-400")),this.panelProducts.innerHTML=this.getPanelProductHtml(t,"Body")}else o.innerHTML=this.getRemainingHtml(null,null),o.classList.add("lg:block"),n.classList.add("hidden"),a.classList.add("hidden"),s.forEach(d=>d.setAttribute("disabled",!0)),i.forEach(d=>d.innerText="$0"),this.panelProducts.innerHTML=""}handleModalOpen(e){e.preventDefault();let t=[localStorage.getItem("osea.byobFaceProductId"),localStorage.getItem("osea.byobBodyProductId")],o=e.currentTarget.closest(".bundle-card"),{productHandle:n,variantId:a}=o.dataset;fetch(`${window.Shopify.routes.root}products/${n}.json`).then(s=>s.json()).then(s=>{let{body_html:i,images:d,title:l,variants:u}=s.product,h=this.querySelector("#ByobModal .content"),S=o.querySelector(".rating").innerHTML,E=o.querySelector(".byob-add-to-bundle"),m=JSON.parse(a),P=u.find(c=>c.id===m),{name:p}=E.dataset;h.innerHTML=`<div class="flex sm:flex-col overflow-x-auto sm:overflow-y-auto mb-4 gap-1 sm:absolute sm:inset-y-0 sm:w-1/2 sm:pr-3">
					${d.filter(c=>{let{variant_ids:f}=c;return u.length===1||u.length>1&&(f.length===0||f.includes(m))}).slice(0,6).map(c=>`
									<img
										srcset="${c.src}&width=328&auto=format,compress 1x, ${c.src}&width=656&auto=format,compress 2x"
										src="${c.src}&width=656"
										alt=""
										loading="lazy"
										width="${c.width}"
										height="${c.height}"
										class="block bg-wave-200 w-48 sm:w-full ${c.variant_ids.includes(m)?"order-1":"order-2"}"
									>
								`).join("")}
				</div>
				<div class="sm:w-1/2 sm:ml-auto sm:pl-4 sm:min-h-[32rem] sm:flex sm:flex-col">
					<div class="flex items-center mb-2">${S}</div>
					<h1 class="text-lg font-medium tracking-wide mb-2 leading-tight">${l}</h1>
					<div class="p:mb-3 mb-6">${i}</div>
					<div class="sticky bottom-0 bg-white py-4 mt-auto">
						<label for="Input-${a}" data-name="${p}" onclick="this.closest('bundle-builder').handleModalAdd('${a}', '${n}', '${p}')" class="button button-primary w-full justify-between">
							<span>${t.includes(a)?"Added!":"Add"}</span>
							<span>${this.getPriceHtml(parseInt(P.price*100),"text-seaweed-400")}</span>
						</label>
					</div>
				</div>`}).catch(s=>console.error(s))}handleModalAdd(e,t,o){this.handleAddToBundle(null,e,t,o),this.querySelector("modal-dialog").hide()}handleRemove(e,t){localStorage.removeItem(`osea.byob${t}ProductId`),this.querySelector(`#Input-${e}`).checked=!1,this.renderElements()}handleAddToBundle(e,t,o,n){let a=t||e.currentTarget.closest(".bundle-card").dataset.variantId,s=o||e.currentTarget.closest(".bundle-card").dataset.productHandle,i=n||e.currentTarget.dataset.name;i==="byob-face"&&(localStorage.setItem("osea.byobFaceProductId",a),localStorage.setItem("osea.byobFaceProductHandle",s)),i==="byob-body"&&(localStorage.setItem("osea.byobBodyProductId",a),localStorage.setItem("osea.byobBodyProductHandle",s)),this.renderElements()}handleAddToCart(){let e=localStorage.getItem("osea.byobFaceProductHandle"),o=`${localStorage.getItem("osea.byobBodyProductHandle")}-${e}`;fetch(`${window.Shopify.routes.root}products/${o}.json`).then(n=>n.json()).then(n=>{let a=JSON.stringify({items:[{id:n.product.variants[0].id,quantity:1,properties:{_bundle:o}}]});fetch(`${routes.cart_add_url}`,w(v({},$()),{body:a})).then(s=>s.json()).then(s=>{this.cart.renderContents(s)}).catch(s=>console.error(s)).finally(()=>{})}).catch(n=>console.error(n))}};customElements.define("bundle-builder",b);})();
