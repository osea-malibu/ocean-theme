var w=Object.defineProperty,P=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var g=(l,e,t)=>e in l?w(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,f=(l,e)=>{for(var t in e||(e={}))L.call(e,t)&&g(l,t,e[t]);if(y)for(var t of y(e))B.call(e,t)&&g(l,t,e[t]);return l},$=(l,e)=>P(l,I(e));import{f as T}from"./utils.min.js";class x extends HTMLElement{constructor(){super(),this.cart=document.querySelector("cart-drawer"),this.panelProducts=this.querySelector("#ByobPanel .products"),this.querySelectorAll("modal-opener").forEach(e=>e.addEventListener("click",this.handleModalOpen.bind(this))),this.querySelectorAll(".byob-add-to-bundle").forEach(e=>e.addEventListener("click",this.handleAddToBundle.bind(this))),this.querySelectorAll(".byob-add-to-cart").forEach(e=>e.addEventListener("click",this.handleAddToCart.bind(this)))}connectedCallback(){const e=localStorage.getItem("osea.byobFaceProductId"),t=localStorage.getItem("osea.byobBodyProductId");e&&(this.querySelector(`#Input-${e}`).checked=!0),t&&(this.querySelector(`#Input-${t}`).checked=!0),this.renderElements()}getPanelProductHtml(e,t){const s=this.querySelector(`[data-variant-id="${e}"] img`),o=this.querySelector(`[data-variant-id="${e}"] .info`).innerHTML,d=this.querySelector(`[data-variant-id="${e}"] .price`).innerHTML;return`<div class="flex gap-4 py-4 border-b border-white first-of-type:pt-8">
			<img
				srcset="${s.getAttribute("srcset")}"
				srcset="${s.getAttribute("src")}"
				alt=""
				loading="lazy"
				width="{{ product.featured_media.width }}"
				height="{{ product.featured_media.height }}"
				class="block bg-white w-16"
			>
			<div>${o}</div>
			<div class="ml-auto flex flex-col items-end">
				<div class="whitespace-nowrap font-medium">${d}</div>
				<button class="link font-book tracking-wide text-sm" onclick="this.closest('bundle-builder').handleRemove('${e}', '${t}')">Remove</button>
			</div>
		</div>`}getPriceHtml(e,t){return`<div class="flex-row">
			<span class="sr-only">Regular price</span>
			<span>
				<s class="${t}">$${e/100}</s>
			</span>
			<span class="sr-only">Sale price</span>
			<span>$${(e*.8/100).toFixed(2)}</span>
		</div>`}getRemainingHtml(e,t){return e&&t?'<p class="text-lg lg:hidden whitespace-nowrap"><b>2/2</b><span class="hidden xs:inline"> products</span> selected</p><p class="sr-only">Your bundle is complete!</p>':`<p class="text-lg lg:text-2xl whitespace-nowrap"><b>${!e&&!t?0:1}/2</b> products selected</p>
			<p class="hidden lg:block mt-3 leading-5 lg:max-w-sm lg:mx-auto${!e&&!t?" mb-12":""}">
				<span class="font-system-sans font-medium">‚Üê</span> Add ${e?"":"<b>one face</b>"}${!e&&!t?" and ":" "}${t?"":"<b>one body</b>"} product to complete your bundle
			</p>`}renderElements(){const e=localStorage.getItem("osea.byobFaceProductId"),t=localStorage.getItem("osea.byobBodyProductId"),s=this.querySelector("#ByobBar .remaining"),o=this.querySelector("#ByobBar .byob-add-to-cart"),d=this.querySelector("#ByobBar .total-cost"),a=this.querySelectorAll(".byob-add-to-cart"),i=this.querySelectorAll(".total-cost");if(e&&t){const r=parseInt(this.querySelector(`[data-variant-id="${e}"]`).dataset.price),n=parseInt(this.querySelector(`[data-variant-id="${t}"]`).dataset.price),u=r+n;s.innerHTML=this.getRemainingHtml(e,t),s.classList.remove("lg:block"),o.classList.remove("hidden"),d.classList.add("hidden"),a.forEach(h=>h.removeAttribute("disabled")),i.forEach(h=>h.innerHTML=this.getPriceHtml(u,"text-wave-500")),this.panelProducts.innerHTML=`${this.getPanelProductHtml(e,"Face")}${this.getPanelProductHtml(t,"Body")}`}else if(e&&!t){const r=parseInt(this.querySelector(`[data-variant-id="${e}"]`).dataset.price);s.innerHTML=this.getRemainingHtml(e,null),s.classList.add("lg:block"),o.classList.add("hidden"),d.classList.remove("hidden"),a.forEach(n=>n.setAttribute("disabled",!0)),i.forEach(n=>n.innerHTML=this.getPriceHtml(r,"text-seaweed-400")),this.panelProducts.innerHTML=this.getPanelProductHtml(e,"Face")}else if(!e&&t){const r=parseInt(this.querySelector(`[data-variant-id="${t}"]`).dataset.price);s.innerHTML=this.getRemainingHtml(null,t),s.classList.add("lg:block"),o.classList.add("hidden"),d.classList.remove("hidden"),a.forEach(n=>n.setAttribute("disabled",!0)),i.forEach(n=>n.innerHTML=this.getPriceHtml(r,"text-seaweed-400")),this.panelProducts.innerHTML=this.getPanelProductHtml(t,"Body")}else s.innerHTML=this.getRemainingHtml(null,null),s.classList.add("lg:block"),o.classList.add("hidden"),d.classList.add("hidden"),a.forEach(r=>r.setAttribute("disabled",!0)),i.forEach(r=>r.innerText="$0"),this.panelProducts.innerHTML=""}handleModalOpen(e){e.preventDefault();const t=[localStorage.getItem("osea.byobFaceProductId"),localStorage.getItem("osea.byobBodyProductId")],s=e.currentTarget.closest(".bundle-card"),{productHandle:o,variantId:d}=s.dataset;fetch(`${window.Shopify.routes.root}products/${o}.json`).then(a=>a.json()).then(a=>{const{body_html:i,images:r,title:n,variants:u}=a.product,h=this.querySelector("#ByobModal .content"),v=s.querySelector(".rating").innerHTML,H=s.querySelector(".byob-add-to-bundle"),b=JSON.parse(d),S=u.find(c=>c.id===b),{name:m}=H.dataset;h.innerHTML=`<div class="flex sm:flex-col overflow-x-auto sm:overflow-y-auto mb-4 gap-1 sm:absolute sm:inset-y-0 sm:w-1/2 sm:pr-3">
					${r.filter(c=>{const{variant_ids:p}=c;return u.length===1||u.length>1&&(p.length===0||p.includes(b))}).slice(0,6).map(c=>`
									<img
										srcset="${c.src}&width=328&auto=format,compress 1x, ${c.src}&width=656&auto=format,compress 2x"
										src="${c.src}&width=656"
										alt=""
										loading="lazy"
										width="${c.width}"
										height="${c.height}"
										class="block bg-wave-200 w-48 sm:w-full ${c.variant_ids.includes(b)?"order-1":"order-2"}"
									>
								`).join("")}
				</div>
				<div class="sm:w-1/2 sm:ml-auto sm:pl-4 sm:min-h-[32rem] sm:flex sm:flex-col">
					<div class="flex items-center mb-2">${v}</div>
					<h1 class="text-lg font-medium tracking-wide mb-2 leading-tight">${n}</h1>
					<div class="p:mb-3 mb-6">${i}</div>
					<div class="sticky bottom-0 bg-white py-4 mt-auto">
						<label for="Input-${d}" data-name="${m}" onclick="this.closest('bundle-builder').handleModalAdd('${d}', '${o}', '${m}')" class="button button-primary w-full justify-between">
							<span>${t.includes(d)?"Added!":"Add"}</span>
							<span>${this.getPriceHtml(parseInt(S.price*100),"text-seaweed-400")}</span>
						</label>
					</div>
				</div>`}).catch(a=>console.error(a))}handleModalAdd(e,t,s){this.handleAddToBundle(null,e,t,s),this.querySelector("modal-dialog").hide()}handleRemove(e,t){localStorage.removeItem(`osea.byob${t}ProductId`),this.querySelector(`#Input-${e}`).checked=!1,this.renderElements()}handleAddToBundle(e,t,s,o){const d=t||e.currentTarget.closest(".bundle-card").dataset.variantId,a=s||e.currentTarget.closest(".bundle-card").dataset.productHandle,i=o||e.currentTarget.dataset.name;i==="byob-face"&&(localStorage.setItem("osea.byobFaceProductId",d),localStorage.setItem("osea.byobFaceProductHandle",a)),i==="byob-body"&&(localStorage.setItem("osea.byobBodyProductId",d),localStorage.setItem("osea.byobBodyProductHandle",a)),this.renderElements()}handleAddToCart(){const e=localStorage.getItem("osea.byobFaceProductHandle"),s=`${localStorage.getItem("osea.byobBodyProductHandle")}-${e}`;fetch(`${window.Shopify.routes.root}products/${s}.json`).then(o=>o.json()).then(o=>{const d=JSON.stringify({items:[{id:o.product.variants[0].id,quantity:1,properties:{_bundle:s}}]});fetch(`${routes.cart_add_url}`,$(f({},T()),{body:d})).then(a=>a.json()).then(a=>{this.cart.renderContents(a)}).catch(a=>console.error(a)).finally(()=>{})}).catch(o=>console.error(o))}}customElements.define("bundle-builder",x);
